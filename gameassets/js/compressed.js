var activeScene,bootScene=new Phaser.Scene("boot");bootScene.preload=function(){this.load.image("rubbleLogoLarge","gameassets/images/rubbleLogoLargeBorder.png")},bootScene.create=function(){this.scene.start("preload")};var mute,jsonText,possibleResponsesArray,possibleIngredientsArray,loadingText,lang,siteReady=!1,preloadScene=new Phaser.Scene("preload");preloadScene.preload=function(){var e=this.add.image(512,200,"rubbleLogoLarge");e.alpha=0,loadingText=this.add.text(447,350,"Loading...",{fontSize:"38px",fill:"#fff"}).setFontFamily("Arial"),this.tweens.add({targets:e,alpha:1,ease:"Sine.easeIn",duration:2e3}),this.load.spritesheet("madScientist","gameassets/images/pixelMadScientist.png",{frameWidth:64,frameHeight:96}),this.load.spritesheet("monsters","gameassets/images/pixelZombie.png",{frameWidth:48,frameHeight:96}),this.load.spritesheet("victims","gameassets/images/pixelMan.png",{frameWidth:64,frameHeight:96}),this.load.spritesheet("speechBubble","gameassets/images/speechBubbleAnim.png",{frameWidth:178,frameHeight:146}),this.load.spritesheet("computer","gameassets/images/computer.png",{frameWidth:156,frameHeight:134}),this.load.spritesheet("treadmill","gameassets/images/treadmill.png",{frameWidth:86,frameHeight:76}),this.load.spritesheet("ingredients","gameassets/images/ingredients.png",{frameWidth:38,frameHeight:32}),this.load.spritesheet("electricEffect","gameassets/images/electricEffect24x24.png",{frameWidth:24,frameHeight:24}),this.load.spritesheet("zombieDeath","gameassets/images/zombieDeathTrimmed.png",{frameWidth:96,frameHeight:96}),this.load.spritesheet("conveyor","gameassets/images/conveyor_belt.png",{frameWidth:400,frameHeight:50}),this.load.spritesheet("crates","gameassets/images/crates.png",{frameWidth:64,frameHeight:64}),this.load.spritesheet("splatter","gameassets/images/splatter.png",{frameWidth:400,frameHeight:300}),this.load.audio("pop",["gameassets/audio/pop.mp3"]),this.load.audio("conveyor",["gameassets/audio/conveyor_belt.mp3"]),this.load.audio("growl",["gameassets/audio/growl.mp3"]),this.load.audio("zap",["gameassets/audio/laserPulse.mp3"]),this.load.audio("treadmill",["gameassets/audio/treadmill.mp3"]),this.load.audio("win",["gameassets/audio/win.mp3"]),this.load.audio("woosh",["gameassets/audio/woosh.mp3"]),this.load.audio("scream",["gameassets/audio/scream.mp3"]),this.load.audio("squelch",["gameassets/audio/squelch.mp3"]),this.load.audio("smash",["gameassets/audio/woodSmash.mp3"]),this.load.image("officeBackground","gameassets/images/officeBackground.png"),this.load.image("labBackground","gameassets/images/labBackground.png"),this.load.image("blankBackground","gameassets/images/blankBackground.png"),this.load.image("menuBackground","gameassets/images/titleScreen.png"),this.load.image("labSign","gameassets/images/labSign.png"),this.load.image("table","gameassets/images/table.png"),this.load.image("buttonLong","gameassets/images/button200x66blue.png"),this.load.image("buttonLarge","gameassets/images/pixelBlankButton240x80.png"),this.load.json("text","gameassets/js/gameText.json")},preloadScene.create=function(){activeScene="preload",LoLApi("gameIsReady",{aspectRatio:"16:9",resolution:"1024x576"}),loadingText.text=" Ready";var e=this;window.addEventListener("message",function(a){var{messageName:t,payload:s}=a.data;switch(a.data.messageName){case"start":var i=JSON.parse(a.data.payload);lang=i.languageCode,siteReady=!0;break;case"pause":e.scene.pause(activeScene),e.sound.pauseAll(),console.log("paused");break;case"resume":e.scene.resume(activeScene),e.sound.resumeAll(),console.log("resumed");}})},preloadScene.update=function(){siteReady&&(siteReady=!1,this.loadPage())},preloadScene.loadPage=function(){jsonText=this.cache.json.get("text"),jsonText=jsonText[lang],this.animsCreate(),possibleIngredientsArray=[[jsonText.possIngredients0,0],[jsonText.possIngredients1,1],[jsonText.possIngredients2,2],[jsonText.possIngredients3,3],[jsonText.possIngredients4,4],[jsonText.possIngredients5,5]],possibleResponsesArray=[jsonText.possResponses0,jsonText.possResponses1,jsonText.possResponses2];var e=this.add.sprite(512,375,"buttonLarge").setInteractive({useHandCursor:!0});e.on("pointerdown",this.start),this.add.text(517,375,jsonText.pre1,{fontSize:"38px",fill:"#000"}).setFontStyle("bold italic").setFontFamily("Arial").setPadding({right:16}).setOrigin(.5);var a=this.add.sprite(512,475,"buttonLarge").setInteractive({useHandCursor:!0});a.on("pointerdown",this.startMuted),this.add.text(517,475,jsonText.pre2,{fontSize:"38px",fill:"#000"}).setFontStyle("bold italic").setFontFamily("Arial").setPadding({right:16}).setOrigin(.5)},preloadScene.start=function(){preloadScene.scene.stop("preload"),preloadScene.scene.start("menu")},preloadScene.startMuted=function(){mute=!0,preloadScene.scene.stop("preload"),preloadScene.scene.start("menu")},preloadScene.animsCreate=function(){this.anims.create({key:"msStand",frames:this.anims.generateFrameNumbers("madScientist",{frames:[0,1,0,1,0,1,2,0,2,1,2,0,1,0,1,2,0,1,3,0,3,1]}),frameRate:6,repeat:-1}),this.anims.create({key:"msTalk",frames:this.anims.generateFrameNumbers("madScientist",{frames:[6,7,6,7,6,7,8,7,8,6,7,6,7,8,6,7,3,6,7,6,7]}),frameRate:8,repeat:-1}),this.anims.create({key:"msWalk",frames:this.anims.generateFrameNumbers("madScientist",{frames:[4,0,5]}),frameRate:6,repeat:-1}),this.anims.create({key:"victimRun",frames:this.anims.generateFrameNumbers("victims",{frames:[1,3,2,3]}),frameRate:8,repeat:-1}),this.anims.create({key:"monsterRun",frames:this.anims.generateFrameNumbers("monsters",{frames:[3,5,4,5]}),frameRate:8,repeat:-1}),this.anims.create({key:"bubbleOpen",frames:this.anims.generateFrameNumbers("speechBubble",{frames:[0,1,2,3]}),frameRate:16,repeat:0}),this.anims.create({key:"bubbleClose",frames:this.anims.generateFrameNumbers("speechBubble",{frames:[3,2,1,0]}),frameRate:16,repeat:0}),this.anims.create({key:"treadmillActive",frames:this.anims.generateFrameNumbers("treadmill",{frames:[0,1,2]}),frameRate:16,repeat:-1}),this.anims.create({key:"electricEffect",frames:this.anims.generateFrameNumbers("electricEffect",{frames:[0,1,2,3]}),frameRate:12,repeat:-1}),this.anims.create({key:"death",frames:this.anims.generateFrameNumbers("zombieDeath",{frames:[0,1,2]}),frameRate:6,repeat:0}),this.anims.create({key:"conveyorActive",frames:this.anims.generateFrameNumbers("conveyor",{frames:[0,1,2,3,1,2,3,1,2]}),frameRate:16,repeat:-1}),this.anims.create({key:"conveyorActiveRight",frames:this.anims.generateFrameNumbers("conveyor",{frames:[3,2,1,0,2,1,3,2,1]}),frameRate:16,repeat:-1})};var menuScene=new Phaser.Scene("menu");menuScene.create=function(){activeScene="menu";var e=this.add.image(512,288,"menuBackground"),a=this.add.sprite(512,375,"buttonLarge").setInteractive({useHandCursor:!0});if(a.on("pointerdown",this.start),this.add.text(517,375,jsonText.pre1,{fontSize:"38px",fill:"#000"}).setFontStyle("bold italic").setFontFamily("Arial").setPadding({right:16}).setOrigin(.5),!mute){var t=this.sound.add("growl");t.play(),LoLApi("speakText",{key:"title"})}},menuScene.start=function(){menuScene.scene.stop("menu"),menuScene.scene.start("main")};var madScientistSprite,bubbleSprite,dataTable,line,xArray,graphAxisTextArray,nextButton,nextButtonLabel,againButton,againButtonLabel,bubbleSprite,bubbleText,bubbleSpriteTwo,bubbleTextTwo,lineButton,lineButtonLabel,stemButton,stemButtonLabel,ingredientsButtonArray,correctGraphType,broken,brokenStemLeafArray,brokenLinePlotArray,brokenAmount,brokenType,unitsOnlyArray,winSfx,textNumber=0,namesArray=[],speedArray=[],lifeArray=[],speedArrayOriginal=[],lifeArrayOriginal=[],speedArray1=[],lifeArray1=[],speedArray2=[],lifeArray2=[],speedArray3=[],lifeArray3=[],stemPlotArray=[],sortedDisplayArray=[],extraIngredient1={name:"none",speed:0,lifetime:0,frame:0},extraIngredient2={name:"none",speed:0,lifetime:0},extraIngredient3={name:"none",speed:0,lifetime:0},bubbleVisible=!1,bubbleTwoVisible=!1,highestRowButtonArray=[],highestColumnButtonArray=[],activeBrokenData="none",brokenLineDataArray=[],brokenStemDataArray=[],mainScene=new Phaser.Scene("main");mainScene.create=function(){activeScene="main",0==textNumber&&(this.shuffle(possibleIngredientsArray),this.shuffle(possibleResponsesArray)),broken=!1,ingredientsButtonArray=[],brokenStemLeafArray=[],brokenLinePlotArray=[],unitsOnlyArray=[];var e=this.add.image(512,276,"officeBackground");e.setScale(2),madScientistSprite=this.add.sprite(810,480,"madScientist"),madScientistSprite.setScale(2),madScientistSprite.anims.play("msStand");var a=this.changeText();this.createBubble(715,276,a,!0);var t=this.add.image(200,452,"computer");t.setScale(.65);var s=this.add.image(200,536,"table");s.setScale(1.25),dataTable=this.add.sprite(320,280,"computer"),dataTable.setFrame(1),dataTable.setScale(4),dataTable.visible=!1,nextButton=this.add.sprite(512,530,"buttonLarge").setInteractive({useHandCursor:!0});var i=this;nextButton.on("pointerdown",function(){bubbleVisible&&(bubbleText.text="",bubbleSprite.anims.play("bubbleClose")),bubbleTwoVisible&&(bubbleTextTwo.text="",bubbleSpriteTwo.anims.play("bubbleClose")),i.time.delayedCall(500,function(){mainScene.nextStep()},[],this)}),nextButton.visible=!1,nextButtonLabel=this.add.text(517,530,jsonText.mainButton1,{fontSize:"34px",fill:"#000"}).setFontStyle("bold italic").setFontFamily("Arial").setPadding({right:16}).setOrigin(.5),nextButtonLabel.visible=!1,mute||(speechBubbleSfx=this.sound.add("pop"))},mainScene.nextStep=function(){bubbleText.text="",madScientistSprite.anims.play("msStand"),nextButton.visible=!1,nextButtonLabel.visible=!1;var e;if(6==textNumber&&!dataTable.visible)mainScene.showData(4,10);else if(8==textNumber)mainScene.createStemAndLeafPlot(lifeArray);else if(8.5==textNumber)e=mainScene.changeText(),mainScene.createBubble(715,276,e,!1);else if(10==textNumber)mainScene.createStemAndLeafPlot(speedArray);else if(12==textNumber)mainScene.createLinePlot(speedArray);else if(14==textNumber)mainScene.hideData(),mainScene.addIngredients(),e=mainScene.changeText(),mainScene.createBubble(715,276,e,!0);else if(15==textNumber)e=mainScene.changeText(),mainScene.createBubble(715,276,e,!1);else if(16==textNumber)mainScene.zoomToLab();else if(17==textNumber&&!dataTable.visible)mainScene.showData(extraIngredient1.speed,extraIngredient1.lifetime);else if(19==textNumber){for(var a=0;a<lifeArray.length;a++)namesArray[a].visible=!1,lifeArray[a].visible=!1;mainScene.chooseGraph(lifeArray)}else if(20==textNumber)mainScene.hideData(!0),broken=!0,mainScene.createStemAndLeafPlot(lifeArray);else if(23==textNumber)mainScene.chooseGraph(speedArray);else if(24==textNumber){for(var a=0;a<unitsOnlyArray.length;a++)unitsOnlyArray[a].visible=!1;for(var a=0;a<stemPlotArray.length;a++)stemPlotArray[a].visible=!1;for(var a=0;a<sortedDisplayArray.length;a++)sortedDisplayArray[a].visible=!1;mainScene.hideData(!0),broken=!0,mainScene.createLinePlot(speedArray)}else 27==textNumber?(e=mainScene.changeText(),mainScene.createBubble(715,276,e,!1)):28==textNumber?(mainScene.reset(),mainScene.scene.stop("main"),mainScene.scene.start("menu")):(e=mainScene.changeText(),mainScene.createBubble(715,276,e,!0))},mainScene.reset=function(){textNumber=0,namesArray=[],speedArray=[],lifeArray=[],stemPlotArray=[],sortedDisplayArray=[]},mainScene.createBubble=function(e,a,t,s){bubbleVisible&&(bubbleText.text="",bubbleSprite.destroy(),bubbleVisible=!1),bubbleTwoVisible&&(bubbleTextTwo.text="",bubbleSpriteTwo.destroy(),bubbleTwoVisible=!1),bubbleSprite=this.add.sprite(e,a,"speechBubble"),bubbleSprite.setScale(2),bubbleSprite.setTint(16711601),bubbleVisible=!0,bubbleSprite.on("animationcomplete",function(e,a){this.emit("animationcomplete_"+e.key,e,a)},bubbleSprite),bubbleSprite.anims.play("bubbleOpen"),bubbleSprite.on("animationcomplete_bubbleOpen",function(){bubbleSprite.setFrame(3)}),bubbleSprite.on("animationcomplete_bubbleClose",function(){bubbleSprite.destroy(),bubbleVisible=!1}),bubbleText=this.add.text(e,a-20,t,{fontSize:"26px",fill:"#000",wordWrap:{width:320,useAdvancedWrap:!0}}).setFontFamily("Verdana").setOrigin(.5),bubbleText.visible=!1,this.time.delayedCall(250,function(){bubbleText.visible=!0,madScientistSprite.anims.play("msTalk"),mute||speechBubbleSfx.play()},[],this),this.time.delayedCall(7250,function(){madScientistSprite.anims.play("msStand"),broken||!s?(bubbleText.text="",bubbleVisible&&bubbleSprite.anims.play("bubbleClose")):s&&(nextButton.visible=!0,nextButtonLabel.visible=!0)},[],this)},mainScene.createBubbleTwo=function(e,a,t,s){bubbleTwoVisible&&(bubbleTextTwo.text="",bubbleSpriteTwo.destroy(),bubbleTwoVisible=!1),bubbleSpriteTwo=this.add.sprite(e,a,"speechBubble"),bubbleSpriteTwo.setScale(2),bubbleSpriteTwo.setTint(16711601),bubbleTwoVisible=!0,bubbleSpriteTwo.on("animationcomplete",function(e,a){this.emit("animationcomplete_"+e.key,e,a)},bubbleSpriteTwo),bubbleSpriteTwo.anims.play("bubbleOpen"),bubbleSpriteTwo.on("animationcomplete_bubbleOpen",function(){bubbleSpriteTwo.setFrame(3)}),bubbleSpriteTwo.on("animationcomplete_bubbleClose",function(){bubbleSpriteTwo.destroy(),bubbleTwoVisible=!1}),bubbleTextTwo=this.add.text(e,a-20,t,{fontSize:"26px",fill:"#000",wordWrap:{width:320,useAdvancedWrap:!0}}).setFontFamily("Verdana").setOrigin(.5),bubbleTextTwo.visible=!1,this.time.delayedCall(250,function(){bubbleTextTwo.visible=!0,madScientistSprite.anims.play("msTalk"),mute||speechBubbleSfx.play()},[],this),this.time.delayedCall(6500,function(){madScientistSprite.anims.play("msStand"),broken||!s?(bubbleTextTwo.text="",bubbleTwoVisible&&bubbleSpriteTwo.anims.play("bubbleClose")):s&&(nextButton.visible=!0,28==textNumber&&(!mute&&winSfx.play(),nextButtonLabel.text=jsonText.mainButton2),nextButtonLabel.visible=!0)},[],this)},mainScene.changeText=function(){var e,a,t;switch(textNumber){case 0:e=jsonText.mainText0,mute||LoLApi("speakText",{key:"mainText0"}),textNumber++;break;case 1:e=jsonText.mainText1,mute||LoLApi("speakText",{key:"mainText1"}),textNumber++;break;case 2:e=jsonText.mainText2,mute||LoLApi("speakText",{key:"mainText2"}),textNumber++;break;case 3:e=jsonText.mainText3,mute||LoLApi("speakText",{key:"mainText3"}),textNumber++;break;case 4:e=jsonText.mainText4,mute||LoLApi("speakText",{key:"mainText4"}),textNumber++;break;case 5:e=jsonText.mainText5,mute||LoLApi("speakText",{key:"mainText5"}),textNumber++;break;case 6:t={currentProgress:1,maximumProgress:13},LoLApi("progress",t),e=jsonText.mainText6,mute||LoLApi("speakText",{key:"mainText6"}),textNumber++;break;case 7:e=jsonText.mainText7,mute||LoLApi("speakText",{key:"mainText7"}),textNumber++;for(var s=0;s<speedArray.length;s++)speedArray[s].visible=!1,this.tweens.add({targets:lifeArray[s],x:"-=190",ease:"Sine.easeIn",duration:500});break;case 8:t={currentProgress:2,maximumProgress:13},LoLApi("progress",t),e=jsonText.mainText8,mute||LoLApi("speakText",{key:"mainText8"}),textNumber+=.5;break;case 8.5:e=jsonText.mainText8_5,mute||LoLApi("speakText",{key:"mainText8_5"}),textNumber+=.5;break;case 9:t={currentProgress:3,maximumProgress:13},LoLApi("progress",t),e=jsonText.mainText9,mute||LoLApi("speakText",{key:"mainText9"}),textNumber++;for(var s=0;s<unitsOnlyArray.length;s++)unitsOnlyArray[s].visible=!1;for(var s=0;s<stemPlotArray.length;s++)stemPlotArray[s].visible=!1;for(var s=0;s<sortedDisplayArray.length;s++)sortedDisplayArray[s].visible=!1;for(var s=0;s<speedArray.length;s++)namesArray[s].visible=!0,speedArray[s].visible=!0;break;case 10:e=jsonText.mainText10,mute||LoLApi("speakText",{key:"mainText10"}),textNumber++;break;case 11:t={currentProgress:4,maximumProgress:13},LoLApi("progress",t),e=jsonText.mainText11,mute||LoLApi("speakText",{key:"mainText11"}),textNumber+=.5;for(var s=0;s<unitsOnlyArray.length;s++)unitsOnlyArray[s].visible=!1;for(var s=0;s<stemPlotArray.length;s++)stemPlotArray[s].visible=!1;for(var s=0;s<sortedDisplayArray.length;s++)sortedDisplayArray[s].visible=!1;for(var s=0;s<speedArray.length;s++)namesArray[s].visible=!0,speedArray[s].visible=!0;break;case 11.5:e=jsonText.mainText11_5,mute||LoLApi("speakText",{key:"mainText11_5"}),textNumber+=.5;break;case 12:for(var n=[],s=0;s<speedArray.length;s++)n.push(parseFloat(speedArray[s].text));e=jsonText.mainText12,mute||LoLApi("speakText",{key:"mainText12"}),textNumber++;break;case 13:6==possibleIngredientsArray.length&&(t={currentProgress:5,maximumProgress:13},LoLApi("progress",t)),e=jsonText.mainText13,mute||LoLApi("speakText",{key:"mainText13"}),textNumber++;break;case 14:e=jsonText.mainText14,mute||LoLApi("speakText",{key:"mainText14"}),textNumber++;break;case 15:e=possibleResponsesArray[0];var l;possibleResponsesArray[0]==jsonText.possResponses0?l="possResponses0":possibleResponsesArray[0]==jsonText.possResponses1?l="possResponses1":possibleResponsesArray[0]==jsonText.possResponses2&&(l="possResponses2"),mute||LoLApi("speakText",{key:l}),possibleResponsesArray.splice(0,1),textNumber++;break;case 16:5==possibleIngredientsArray.length&&(t={currentProgress:7,maximumProgress:13},LoLApi("progress",t)),e=jsonText.mainText16,mute||LoLApi("speakText",{key:"mainText16"}),namesArray=[],speedArrayOriginal=speedArray,speedArray=[],lifeArrayOriginal=lifeArray,lifeArray=[],textNumber++;break;case 17:e=jsonText.mainText17,mute||LoLApi("speakText",{key:"mainText17"}),textNumber++;for(var s=0;s<speedArray.length;s++)speedArray[s].visible=!1,this.tweens.add({targets:lifeArray[s],x:"-=190",ease:"Sine.easeIn",duration:500});break;case 18:5==possibleIngredientsArray.length&&(t={currentProgress:8,maximumProgress:13},LoLApi("progress",t)),e=jsonText.mainText18,mute||LoLApi("speakText",{key:"mainText18"}),textNumber++;break;case 19:correctGraphType?(e=jsonText.mainText19a,textNumber+=2,!mute&&LoLApi("speakText",{key:"mainText19a"})):(e=jsonText.mainText19b,textNumber++,!mute&&LoLApi("speakText",{key:"mainText19b"}));break;case 20:e=jsonText.mainText20,mute||LoLApi("speakText",{key:"mainText20"}),textNumber++;break;case 21:5==possibleIngredientsArray.length&&(t={currentProgress:9,maximumProgress:13},LoLApi("progress",t)),a=extraIngredient1.lifetime-10,e=mainScene.showDifference(a),textNumber++;break;case 22:5==possibleIngredientsArray.length&&(t={currentProgress:10,maximumProgress:13},LoLApi("progress",t));for(var s=0;s<unitsOnlyArray.length;s++)unitsOnlyArray[s].visible=!1;for(var s=0;s<lifeArray.length;s++)lifeArray[s].visible=!1;for(var s=0;s<brokenStemLeafArray.length;s++)brokenStemLeafArray[s].visible=!1;for(var s=0;s<stemPlotArray.length;s++)stemPlotArray[s].visible=!1;for(var s=0;s<sortedDisplayArray.length;s++)sortedDisplayArray[s].visible=!1;for(var s=0;s<namesArray.length;s++)namesArray[s].visible=!0,speedArray[s].visible=!0;for(var s=0;s<brokenStemDataArray.length;s++)brokenStemDataArray[s].visible=!1;e=jsonText.mainText22,mute||LoLApi("speakText",{key:"mainText22"}),textNumber++;break;case 23:correctGraphType?(e=jsonText.mainText23a,textNumber+=2,!mute&&LoLApi("speakText",{key:"mainText23a"})):(mainScene.hideData(!0),e=jsonText.mainText23b,textNumber++,!mute&&LoLApi("speakText",{key:"mainText23b"}));break;case 24:e=jsonText.mainText24,mute||LoLApi("speakText",{key:"mainText24"}),textNumber++;break;case 25:5==possibleIngredientsArray.length&&(t={currentProgress:11,maximumProgress:13},LoLApi("progress",t)),a=extraIngredient1.speed-4,e=mainScene.showDifference(a),textNumber++;break;case 26:5==possibleIngredientsArray.length&&(t={currentProgress:12,maximumProgress:13},LoLApi("progress",t)),mainScene.hideData(!1),e=mainScene.finalResultText(),textNumber++;break;case 27:if(5==possibleIngredientsArray.length&&(t={currentProgress:13,maximumProgress:13},LoLApi("progress",t)),LoLApi("complete",{}),textNumber++,3<possibleIngredientsArray.length){e=jsonText.mainText27b,mute||LoLApi("speakText",{key:"mainText27b"}),againButton=this.add.sprite(512,430,"buttonLarge").setInteractive({useHandCursor:!0});var r=this;againButton.on("pointerdown",function(){bubbleText.text="",bubbleVisible&&bubbleSprite.anims.play("bubbleClose"),r.time.delayedCall(500,function(){mainScene.testAgain()},[],this)}),againButtonLabel=this.add.text(517,430,jsonText.mainButton2,{fontSize:"30px",fill:"#000"}).setFontStyle("bold italic").setFontFamily("Arial").setPadding({right:16}).setOrigin(.5)}else e=jsonText.mainText27a,mute||LoLApi("speakText",{key:"mainText27a"});nextButton.visible=!0,nextButtonLabel.visible=!0,nextButtonLabel.text=jsonText.mainButton3;}return e},mainScene.testAgain=function(){againButton.visible=!1,againButtonLabel.visible=!1,textNumber=14,nextButtonLabel.text=jsonText.mainButton1,mainScene.nextStep()},mainScene.showData=function(e,a){dataTable.visible=!0;var t=this.add.text(80,80,"Subject",{fontSize:"24px",fill:"#008106"}).setFontFamily("Verdana").setFontStyle("bold"),s=this.add.text(240,80,"Top Speed",{fontSize:"24px",fill:"#008106"}).setFontFamily("Verdana").setFontStyle("bold"),n=this.add.text(430,80,"Lifetime",{fontSize:"24px",fill:"#008106"}).setFontFamily("Verdana").setFontStyle("bold");namesArray.push(t),speedArray.push(s),lifeArray.push(n);var l=[e,e+1,e+2,e+3,e,e-1,e-2,e-3,e,e+1,e+2,e,e-1,e-2,e,e+1,e-1];this.shuffle(l),l=l.slice(0,15);for(var r=this.findMode(l);1<r.length;)l.unshift(e),l=l.slice(0,15),r=this.findMode(l);var o=[a,a+1,a+2,a+3,a+4,a-1,a-2,a-3,2*a,2*a+1,2*a+2,2*a+3,2*a-1,2*a-2,2*a-3,3*a,3*a+1,3*a-1,3*a-2,3*a-3];this.shuffle(o);for(var d=1;15>=d;d++){var m=this.add.text(80,90+25*d,"Monster "+d,{fontSize:"16px",fill:"#008106"}).setFontFamily("Verdana"),p=this.add.text(360,108+25*d,l[d-1],{fontSize:"16px",fill:"#008106"}).setFontFamily("Verdana").setOrigin(0,1),g=this.add.text(515,108+25*d,o[d-1],{fontSize:"16px",fill:"#008106"}).setFontFamily("Verdana").setOrigin(0,1);namesArray.push(m),speedArray.push(p),lifeArray.push(g)}this.time.delayedCall(500,function(){nextButton.visible=!0,nextButtonLabel.visible=!0},[],this)},mainScene.showDifference=function(e){var a;return 1<e?(a=jsonText.diffResponse1,!mute&&LoLApi("speakText",{key:"diffResponse1"})):1==e?(a=jsonText.diffResponse2,!mute&&LoLApi("speakText",{key:"diffResponse2"})):0==e?(a=jsonText.diffResponse3,!mute&&LoLApi("speakText",{key:"diffResponse3"})):-1==e?(a=jsonText.diffResponse4,!mute&&LoLApi("speakText",{key:"diffResponse4"})):-1>e&&(a=jsonText.diffResponse5,!mute&&LoLApi("speakText",{key:"diffResponse5"})),a},mainScene.finalResultText=function(){var e,a=extraIngredient1.lifetime-10,t=extraIngredient1.speed-4;return 1<a?1<t?(e=jsonText.finalResponse1,!mute&&LoLApi("speakText",{key:"finalResponse1"})):1==t?(e=jsonText.finalResponse2,!mute&&LoLApi("speakText",{key:"finalResponse2"})):0==t?(e=jsonText.finalResponse2,!mute&&LoLApi("speakText",{key:"finalResponse2"})):-1==t?(e=jsonText.finalResponse2,!mute&&LoLApi("speakText",{key:"finalResponse2"})):-1>t&&(e=jsonText.finalResponse3,!mute&&LoLApi("speakText",{key:"finalResponse3"})):1==a?1<t?(e=jsonText.finalResponse4,!mute&&LoLApi("speakText",{key:"finalResponse4"})):1==t?(e=jsonText.finalResponse5,!mute&&LoLApi("speakText",{key:"finalResponse5"})):0==t?(e=jsonText.finalResponse5,!mute&&LoLApi("speakText",{key:"finalResponse5"})):-1==t?(e=jsonText.finalResponse5,!mute&&LoLApi("speakText",{key:"finalResponse5"})):-1>t&&(e=jsonText.finalResponse6,!mute&&LoLApi("speakText",{key:"finalResponse6"})):0==a?1<t?(e=jsonText.finalResponse4,!mute&&LoLApi("speakText",{key:"finalResponse4"})):1==t?(e=jsonText.finalResponse5,!mute&&LoLApi("speakText",{key:"finalResponse5"})):0==t?(e=jsonText.finalResponse5,!mute&&LoLApi("speakText",{key:"finalResponse5"})):-1==t?(e=jsonText.finalResponse5,!mute&&LoLApi("speakText",{key:"finalResponse5"})):-1>t&&(e=jsonText.finalResponse6,!mute&&LoLApi("speakText",{key:"finalResponse6"})):-1==a?1<t?(e=jsonText.finalResponse4,!mute&&LoLApi("speakText",{key:"finalResponse4"})):1==t?(e=jsonText.finalResponse5,!mute&&LoLApi("speakText",{key:"finalResponse5"})):0==t?(e=jsonText.finalResponse5,!mute&&LoLApi("speakText",{key:"finalResponse5"})):-1==t?(e=jsonText.finalResponse5,!mute&&LoLApi("speakText",{key:"finalResponse5"})):-1>t&&(e=jsonText.finalResponse6,!mute&&LoLApi("speakText",{key:"finalResponse6"})):-1>a&&(1<t?(e=jsonText.finalResponse7,!mute&&LoLApi("speakText",{key:"finalResponse7"})):1==t?(e=jsonText.finalResponse8,!mute&&LoLApi("speakText",{key:"finalResponse8"})):0==t?(e=jsonText.finalResponse8,!mute&&LoLApi("speakText",{key:"finalResponse8"})):-1==t?(e=jsonText.finalResponse8,!mute&&LoLApi("speakText",{key:"finalResponse8"})):-1>t&&(e=jsonText.finalResponse9,!mute&&LoLApi("speakText",{key:"finalResponse9"}))),e},mainScene.hideData=function(e){e||(dataTable.visible=!1),line.visible=!1;for(var a=0;a<xArray.length;a++)xArray[a].visible=!1;for(var a=0;a<graphAxisTextArray.length;a++)graphAxisTextArray[a].visible=!1},mainScene.chooseGraph=function(e){lineButton=this.add.image(200,123,"buttonLarge").setInteractive({useHandCursor:!0}),lineButton.on("pointerdown",function(){23==textNumber&&(broken=!0),this.hideGraphButtons(),this.createLinePlot(e)},this),lineButtonLabel=this.add.text(93,110,jsonText.graphButtonLabel1,{fontSize:"20px",fill:"#000"}).setFontFamily("Verdana"),stemButton=this.add.image(200,223,"buttonLarge").setInteractive({useHandCursor:!0}),stemButton.on("pointerdown",function(){19==textNumber&&(broken=!0),this.hideGraphButtons(),this.createStemAndLeafPlot(e)},this),stemButtonLabel=this.add.text(93,210,jsonText.graphButtonLabel2,{fontSize:"20px",fill:"#000"}).setFontFamily("Verdana")},mainScene.hideGraphButtons=function(){bubbleText.text="",bubbleVisible&&bubbleSprite.anims.play("bubbleClose"),lineButton.visible=!1,lineButtonLabel.visible=!1,stemButton.visible=!1,stemButtonLabel.visible=!1},mainScene.createLinePlot=function(e){for(var a=0;a<speedArray.length;a++)namesArray[a].visible=!1,speedArray[a].visible=!1,lifeArray[a].visible=!1;var t;e==lifeArray?(t="12px",correctGraphType=!1):(t="16px",correctGraphType=!0);for(var s,n=[],a=0;a<e.length;a++)s=e[a].text,n.push(s);n.splice(0,1);var l,r=n.sort(function(e,a){return e-a}),o=0;sortedDisplayArray=[];for(var a=0;a<r.length;a++)l=this.add.text(85+32*a-o,100,r[a],{fontSize:"16px",fill:"#008106"}).setFontFamily("Verdana"),sortedDisplayArray.push(l),10>r[a]&&(o+=8);line=this.add.graphics(),line.visible=!0,line.lineStyle(1,33030,1),line.beginPath(),line.moveTo(100,450),line.lineTo(500,450),line.moveTo(100,450),line.lineTo(100,150),line.closePath(),line.strokePath();var d;graphAxisTextArray=[];for(var m=r[r.length-1]-r[0]+1,p=400/m,a=0;a<m;a++)d=this.add.text(100+(a+.5)*p,475,a+parseFloat(r[0]),{fontSize:t,fill:"#008106"}).setFontFamily("Verdana").setOrigin(.5),graphAxisTextArray.push(d);var g,c=425;xArray=[];for(var u=[],b=[],x=1e3,a=0;a<sortedDisplayArray.length;a++){if(g=100+(r[a]-r[0]+.5)*p,r[a]==r[a-1]?c-=50:c=425,broken&&0==a%2){sortedDisplayArray[a].visible=!1;var y={x:sortedDisplayArray[a].x,y:sortedDisplayArray[a].y,startX:sortedDisplayArray[a].x,startY:sortedDisplayArray[a].y,targetX:g,targetY:c,value:r[a]};brokenLinePlotArray.push(y)}else u.push(g),b.push(c);x+=100,this.tweens.add({targets:sortedDisplayArray[a],x:g,y:c,ease:"Sine.easeIn",delay:x,duration:500}),this.tweens.add({targets:sortedDisplayArray[a],alpha:0,ease:"Sine.easeIn",delay:x+450,duration:50})}broken||12!=textNumber||mainScene.checkHighestColumn(u,r[0]);for(var f,a=0;a<u.length;a++)f=this.add.text(u[a],b[a],"X",{fontSize:"22px",fill:"#008106"}).setFontFamily("Arial").setOrigin(.5),f.alpha=0,this.tweens.add({targets:f,alpha:1,ease:"Sine.easeIn",delay:1675+100*a,duration:25}),xArray.push(f);var h;broken?(h=jsonText.lineBrokenResponse,this.correctBrokenLinePlot()):h=this.changeText(),this.time.delayedCall(1500,function(){12==textNumber||13==textNumber?this.createBubble(715,276,h,!1):this.createBubble(715,276,h,!0),mute||(broken?LoLApi("speakText",{key:"lineBrokenResponse"}):LoLApi("speakText",{key:h}))},[],this)},mainScene.createBrokenDataLine=function(e){var a=this.add.text(brokenLinePlotArray[e].x,brokenLinePlotArray[e].y,brokenLinePlotArray[e].value,{fontSize:"16px",fill:"#008106"}).setFontFamily("Verdana").setInteractive({useHandCursor:!0});a.targetX=brokenLinePlotArray[e].targetX,a.targetY=brokenLinePlotArray[e].targetY,a.startX=brokenLinePlotArray[e].startX,a.startY=brokenLinePlotArray[e].startY,a.unitText=brokenLinePlotArray[e].unitValue,a.matched=!1;var t=this;a.on("pointerdown",function(){for(var e=0;e<brokenLineDataArray.length;e++)brokenLineDataArray[e].setScale(1);a.setScale(1.15),activeBrokenData=a,t.input.on("pointerdown",function(e){if(0<brokenAmount&&"none"!=activeBrokenData)if(e.x>=a.targetX-25&&e.x<=a.targetX+45&&120<=e.y&&510>=e.y){t.tweens.add({targets:a,x:a.targetX-11,y:a.targetY-11,ease:"Sine.easeIn",duration:500});var s=t.add.text(a.targetX,a.targetY,"X",{fontSize:"22px",fill:"#008106"}).setFontFamily("Arial").setOrigin(.5);s.visible=!1,xArray.push(s),t.time.delayedCall(500,function(){a.setScale(1),a.visible=!1,s.visible=!0},[],this),a.matched||(brokenAmount--,a.matched=!0,activeBrokenData="none",0==brokenAmount&&broken&&(broken=!1,speechText=t.changeText(),t.createBubble(715,276,speechText,!0)))}else mainScene.wrongSL()},this)}),brokenLineDataArray.push(a)},mainScene.correctBrokenLinePlot=function(){brokenLineDataArray=[],brokenType="lp",brokenAmount=8;for(var e=0;e<brokenLinePlotArray.length;e++)mainScene.createBrokenDataLine(e)},mainScene.createStemAndLeafPlot=function(e){correctGraphType=!(e!=lifeArray);for(var a=0;a<speedArray.length;a++)namesArray[a].visible=!1,speedArray[a].visible=!1,lifeArray[a].visible=!1;for(var t,s=[],a=0;a<e.length;a++)t=e[a].text,s.push(t);s.splice(0,1);var n,l=s.sort(function(e,a){return e-a}),r=0;sortedDisplayArray=[];for(var a=0;a<l.length;a++)n=this.add.text(85+32*a-r,100,l[a],{fontSize:"16px",fill:"#008106"}).setFontFamily("Verdana"),sortedDisplayArray.push(n),10>l[a]&&(r+=8);var o=l[l.length-1],d=this.add.text(100,150,"Stem",{fontSize:"18px",fill:"#008106"}).setFontFamily("Verdana");d.visible=!1;var m=this.add.text(100,220,0,{fontSize:"16px",fill:"#008106"}).setFontFamily("Verdana");m.visible=!1;var p=this.add.text(100,290,1,{fontSize:"16px",fill:"#008106"}).setFontFamily("Verdana");p.visible=!1;var g=this.add.text(100,360,2,{fontSize:"16px",fill:"#008106"}).setFontFamily("Verdana");g.visible=!1;var c=this.add.text(100,430,3,{fontSize:"16px",fill:"#008106"}).setFontFamily("Verdana");c.visible=!1;var u=this.add.text(202,150,"Leaf",{fontSize:"18px",fill:"#008106"}).setFontFamily("Verdana");u.visible=!1,stemPlotArray.push(d,m,p,g,c,u),this.time.delayedCall(150,function(){d.visible=!0},[],this),this.time.delayedCall(300,function(){m.visible=!0},[],this);var b=1e3,x=32;30<=o?this.time.delayedCall(750,function(){c.visible=!0},[],this):b=750,20<=o?this.time.delayedCall(600,function(){g.visible=!0},[],this):b=600,10<=o?this.time.delayedCall(450,function(){p.visible=!0},[],this):(b=450,10<=o&&20>=o?x=28:10>o&&(x=24)),1e3==b?this.time.delayedCall(900,function(){u.visible=!0},[],this):this.time.delayedCall(b+150,function(){u.visible=!0},[],this);for(var y=202-x,f=220,h=[],k=[],S=[],T=0,v=0,F=0,R=0,a=0;a<sortedDisplayArray.length;a++){if(10>l[a]?(y+=x,sortedDisplayArray[a].unitsText=sortedDisplayArray[a].text,T++):20>l[a]?(10>l[a-1]&&(y=170),y+=x,f=290,sortedDisplayArray[a].unitsText=sortedDisplayArray[a].text-10,v++):30>l[a]?(20>l[a-1]&&(y=170),y+=x,f=360,sortedDisplayArray[a].unitsText=sortedDisplayArray[a].text-20,F++):40>l[a]&&(30>l[a-1]&&(y=170),y+=x,f=430,sortedDisplayArray[a].unitsText=sortedDisplayArray[a].text-30,R++),broken&&0==a%2){sortedDisplayArray[a].visible=!1;var w={x:sortedDisplayArray[a].x,y:sortedDisplayArray[a].y,startX:sortedDisplayArray[a].x,startY:sortedDisplayArray[a].y,targetX:y,targetY:f,value:l[a],unitValue:sortedDisplayArray[a].unitsText};brokenStemLeafArray.push(w)}b+=150,this.tweens.add({targets:sortedDisplayArray[a],x:y,y:f,ease:"Sine.easeIn",delay:b,duration:500}),h.push(y),k.push(f),broken&&0==a%2?S.push(""):S.push(sortedDisplayArray[a].unitsText)}broken||8!=textNumber||mainScene.checkHighestRow(T,v,F,R);for(var C,a=0;a<S.length;a++)C=this.add.text(h[a],k[a],S[a],{fontSize:"16px",fill:"#008106"}).setFontFamily("Verdana"),C.alpha=0,this.tweens.add({targets:C,alpha:1,ease:"Sine.easeIn",delay:b-1750+150*a,duration:50}),unitsOnlyArray.push(C);for(var a=0;a<sortedDisplayArray.length;a++)this.tweens.add({targets:sortedDisplayArray[a],alpha:0,ease:"Sine.easeIn",delay:b-1775+150*a,duration:50});var B;broken?(B=jsonText.stemBrokenResponse,this.correctBrokenStemLeaf()):B=this.changeText(),this.time.delayedCall(b-2e3,function(){this.createBubble(715,276,B,!0),mute||(broken?LoLApi("speakText",{key:"stemBrokenResponse"}):LoLApi("speakText",{key:B}))},[],this)},mainScene.checkHighestRow=function(e,a,t){var s,i;a>t?(s=!0,i=!1):a<t?(s=!1,i=!0):a==t&&(s=!0,i=!0);var n=this.add.sprite(285,228,"buttonLong").setInteractive({useHandCursor:!0});n.setScale(2,1),n.alpha=.01;var l=this.add.sprite(285,298,"buttonLong").setInteractive({useHandCursor:!0});l.setScale(2,1),l.alpha=.01;var r=this.add.sprite(285,368,"buttonLong").setInteractive({useHandCursor:!0});r.setScale(2,1),r.alpha=.01;var o=this.add.sprite(285,438,"buttonLong").setInteractive({useHandCursor:!0});o.setScale(2,1),o.alpha=.01;this;n.on("pointerdown",function(){mainScene.wrongSL()}),s?l.on("pointerdown",function(){mainScene.correctSL()}):l.on("pointerdown",function(){mainScene.wrongSL()}),i?r.on("pointerdown",function(){mainScene.correctSL()}):r.on("pointerdown",function(){mainScene.wrongSL()}),o.on("pointerdown",function(){mainScene.wrongSL()}),highestRowButtonArray=[n,l,r,o]},mainScene.wrongSL=function(){if(9==textNumber||13==textNumber){var e=jsonText.wrongAnswer;mainScene.createBubbleTwo(715,276,e,!1),mute||LoLApi("speakText",{key:"wrongAnswer"})}},mainScene.correctSL=function(){if(9==textNumber){var e=mainScene.changeText();if(mainScene.createBubble(715,276,e,!0),mute||LoLApi("speakText",{key:e}),0<highestRowButtonArray.length)for(var a=0;a<highestRowButtonArray.length;a++)highestRowButtonArray[a].destroy()}},mainScene.correctLP=function(){if(13==textNumber){var e=mainScene.changeText();if(mainScene.createBubble(715,276,e,!0),mute||LoLApi("speakText",{key:e}),0<highestColumnButtonArray.length)for(var a=0;a<highestColumnButtonArray.length;a++)highestColumnButtonArray[a].destroy()}},mainScene.checkHighestColumn=function(e,a){var t,s=this.removeDuplicates(e),n=s[1]-s[0];t=1==a?3:2;for(var l,r=0;r<s.length;r++)l=this.add.sprite(s[r],288,"buttonLong").setInteractive({useHandCursor:!0}),l.setScale(n/200,6),l.alpha=.01,r==t?l.on("pointerdown",function(){mainScene.correctLP()}):l.on("pointerdown",function(){mainScene.wrongSL()}),highestColumnButtonArray.push(l)},mainScene.createBrokenDataStem=function(e){var a=this.add.text(brokenStemLeafArray[e].x,brokenStemLeafArray[e].y,brokenStemLeafArray[e].value,{fontSize:"16px",fill:"#008106"}).setFontFamily("Verdana").setInteractive({useHandCursor:!0});a.targetX=brokenStemLeafArray[e].targetX,a.targetY=brokenStemLeafArray[e].targetY,a.startX=brokenStemLeafArray[e].startX,a.startY=brokenStemLeafArray[e].startY,a.unitText=brokenStemLeafArray[e].unitValue,a.matched=!1;var t=this;a.on("pointerdown",function(){for(var e=0;e<brokenStemDataArray.length;e++)brokenStemDataArray[e].setScale(1);a.setScale(1.15),activeBrokenData=a,t.input.on("pointerdown",function(e){0<brokenAmount&&"none"!=activeBrokenData&&(e.x>=a.targetX-40&&e.x<=a.targetX+60&&e.y>=a.targetY-40&&e.y<=a.targetY+60?(t.tweens.add({targets:a,x:a.targetX,y:a.targetY,ease:"Sine.easeIn",duration:500}),!a.matched&&(a.setScale(1),a.text=a.unitText,brokenAmount--,a.matched=!0,activeBrokenData="none",0==brokenAmount&&broken&&(broken=!1,speechText=t.changeText(),t.createBubble(715,276,speechText,!0)))):mainScene.wrongSL())},this)}),brokenStemDataArray.push(a)},mainScene.correctBrokenStemLeaf=function(){brokenAmount=8,brokenType="s&l";for(var e=0;e<brokenStemLeafArray.length;e++)mainScene.createBrokenDataStem(e)},mainScene.addIngredients=function(){var e=this.add.image(150,100,"buttonLarge").setInteractive({useHandCursor:!0});e.on("pointerdown",function(){this.ingredientSelected(1)},this);var a=this.add.text(45,83,possibleIngredientsArray[0][0],{fontSize:"28px",fill:"#000"}).setFontFamily("Verdana"),t=this.add.image(230,100,"ingredients");t.setScale(2),t.setFrame(possibleIngredientsArray[0][1]);var s=this.add.image(150,200,"buttonLarge").setInteractive({useHandCursor:!0});s.on("pointerdown",function(){this.ingredientSelected(2)},this);var i=this.add.text(45,183,possibleIngredientsArray[1][0],{fontSize:"28px",fill:"#000"}).setFontFamily("Verdana"),n=this.add.image(230,200,"ingredients");n.setScale(2),n.setFrame(possibleIngredientsArray[1][1]);var l=this.add.image(150,300,"buttonLarge").setInteractive({useHandCursor:!0});l.on("pointerdown",function(){this.ingredientSelected(3)},this);var r=this.add.text(45,283,possibleIngredientsArray[2][0],{fontSize:"28px",fill:"#000"}).setFontFamily("Verdana"),o=this.add.image(230,300,"ingredients");o.setScale(2),o.setFrame(possibleIngredientsArray[2][1]),ingredientsButtonArray=[e,a,t,s,i,n,l,r,o]},mainScene.ingredientSelected=function(e){for(var a,t=0;t<ingredientsButtonArray.length;t++)ingredientsButtonArray[t].visible=!1;var s;bubbleVisible&&(bubbleText.text="",bubbleSprite.anims.play("bubbleClose")),1==e?(s=possibleIngredientsArray[0][0],a=possibleIngredientsArray[0][1],possibleIngredientsArray.splice(0,1)):2==e?(s=possibleIngredientsArray[1][0],a=possibleIngredientsArray[1][1],possibleIngredientsArray.splice(1,1)):3==e&&(s=possibleIngredientsArray[2][0],a=possibleIngredientsArray[2][1],possibleIngredientsArray.splice(2,1)),extraIngredient1.name=s,extraIngredient1.frame=a,this.time.delayedCall(250,function(){var e=mainScene.changeText();mainScene.createBubble(715,276,e,!0),mute||LoLApi("speakText",{key:e})},[],this)},mainScene.zoomToLab=function(){var e=this.cameras.main;e.zoomTo(3,1150),e.pan(215,350,700),this.time.delayedCall(1150,function(){e.zoomTo(5,400)},[],this),this.time.delayedCall(1600,function(){mainScene.scene.stop("main"),mainScene.scene.start("warehouse")},[],this)},mainScene.shuffle=function(e){for(var a,t,s=e.length;0!==s;)t=Math.floor(Math.random()*s),s-=1,a=e[s],e[s]=e[t],e[t]=a;return e},mainScene.removeDuplicates=function(e){var a={},e=e.filter(function(t){return!(void 0!==a[t])&&(a[t]=!0,!0)});return e},mainScene.findMode=function(e){var a={},t=[],s=0;for(var n in e)e[n]in a||(a[e[n]]=0),a[e[n]]++,a[e[n]]==s?t.push(e[n]):a[e[n]]>s&&(s=a[e[n]],t=[e[n]]);return t};var cratesArray,ingredientsCollected,correctChoice,correctAvailable,tweenDuration,conveyorBelt,conveyorBelt2,madScientistWarehouse,cratesCollectedText,quelchSfx,smashSfx,speechBubbleSfx,conveyorSFX,warehouseScene=new Phaser.Scene("warehouse");warehouseScene.create=function(){activeScene="warehouse",cratesArray=[],ingredientsCollected=0,correctChoice=extraIngredient1.frame,correctAvailable=!1,tweenDuration=7e3;var e=this.add.image(512,276,"blankBackground");e.setScale(2),conveyorBelt=this.add.sprite(512,526,"conveyor"),conveyorBelt.setScale(3,2),conveyorBelt.anims.play("conveyorActive"),conveyorBelt2=this.add.sprite(512,250,"conveyor"),conveyorBelt2.setScale(3,2),conveyorBelt2.anims.play("conveyorActiveRight");var a=this.add.sprite(470,333,"crates");a.setFrame(correctChoice),a.visible=!1,cratesCollectedText=this.add.text(512,317,"= "+ingredientsCollected,{fontSize:"26px",fill:"#fff"}).setFontFamily("Verdana"),cratesCollectedText.visible=!1;for(var t=9500,s=0;7>s;s++)this.createCrate(t,"left"),this.createCrate(t,"right"),t+=1e3;madScientistWarehouse=this.add.sprite(1180,480,"madScientist"),madScientistWarehouse.setScale(2),madScientistWarehouse.anims.play("msWalk"),this.tweens.add({targets:madScientistWarehouse,x:930,ease:"Sine.easeIn",delay:0,duration:2e3}),this.time.delayedCall(2e3,function(){madScientistWarehouse.anims.stop("msWalk"),madScientistWarehouse.anims.play("msStand")},[],this);var n=jsonText.warehouseSpeech1+extraIngredient1.name+jsonText.warehouseSpeech2;this.time.delayedCall(2250,function(){this.createBubble(835,276,n),mute||LoLApi("speakText",{key:"warehouseSpeech3"})},[],this),this.time.delayedCall(10500,function(){madScientistWarehouse.anims.stop("msStand"),madScientistWarehouse.anims.play("msWalk"),a.visible=!0,cratesCollectedText.visible=!0},[],this),this.tweens.add({targets:madScientistWarehouse,x:1180,ease:"Sine.easeIn",delay:10500,duration:2e3}),mute||(squelchSfx=this.sound.add("squelch"),smashSfx=this.sound.add("smash"),speechBubbleSfx=this.sound.add("pop"),conveyorSFX=this.sound.add("conveyor",{loop:!0,volume:.3}),conveyorSFX.play())},warehouseScene.createCrate=function(e,a){var t,s,i,n,l=[0,1,2,3,4,5,correctChoice];correctAvailable?n=l[Math.floor(Math.random()*l.length)]:(n=correctChoice,correctAvailable=!0),"left"==a?(t=1200,s=410,i=-200):(t=-200,s=134,i=1200);var r=this.add.sprite(t,s,"crates").setInteractive({useHandCursor:!0});r.setScale(2),r.setFrame(n),r.frameUsed=n,r.direction=a,r.on("pointerdown",function(){r.visible=!1,warehouseScene.crateClicked(r.frameUsed)}),r.tween1=this.tweens.add({targets:r,x:i,ease:"Sine.easeIn",delay:e,duration:function(){return tweenDuration},repeat:-1,onRepeat:function(){r.visible=!0,r.tween1.restart()}}),cratesArray.push(r)},warehouseScene.crateClicked=function(e){e==correctChoice?(ingredientsCollected++,!mute&&smashSfx.play(),cratesCollectedText.text="= "+ingredientsCollected,3==ingredientsCollected?tweenDuration=5200:9==ingredientsCollected?tweenDuration=4300:9==ingredientsCollected?tweenDuration=3400:12==ingredientsCollected?tweenDuration=2650:15==ingredientsCollected&&(tweenDuration=7e3,this.time.delayedCall(750,function(){warehouseScene.endScene()},[],this))):warehouseScene.splatter(e)},warehouseScene.splatter=function(e){var a=this.add.sprite(512,276,"splatter");a.setFrame(e),a.setScale(3,2),this.tweens.add({targets:a,alpha:0,ease:"Sine.easeIn",delay:250,duration:2e3}),mute||squelchSfx.play()},warehouseScene.endScene=function(){for(var e=0;e<cratesArray.length;e++)cratesArray[e].tween1.stop();mute||conveyorSFX.stop(),conveyorBelt.anims.stop("conveyorActive"),conveyorBelt.setFrame(3),conveyorBelt2.anims.stop("conveyorActiveRight"),conveyorBelt2.setFrame(3);var a=this.add.sprite(512,526,"buttonLarge").setInteractive({useHandCursor:!0});a.on("pointerdown",this.toTheLab),this.add.text(517,526,jsonText.warehouseButton1,{fontSize:"38px",fill:"#000"}).setFontStyle("bold italic").setFontFamily("Arial").setPadding({right:16}).setOrigin(.5)},warehouseScene.toTheLab=function(){warehouseScene.scene.stop("warehouse"),warehouseScene.scene.start("lab")},warehouseScene.createBubble=function(e,a,t){var s=this.add.sprite(e,a,"speechBubble");s.setScale(2),s.setTint(16711601),s.on("animationcomplete",function(e,a){this.emit("animationcomplete_"+e.key,e,a)},s),s.anims.play("bubbleOpen"),s.on("animationcomplete_bubbleOpen",function(){s.setFrame(3)}),s.on("animationcomplete_bubbleClose",function(){s.destroy()});var i=this.add.text(e,a-20,t,{fontSize:"26px",fill:"#000",wordWrap:{width:320,useAdvancedWrap:!0}}).setFontFamily("Verdana").setOrigin(.5);i.visible=!1,this.time.delayedCall(250,function(){i.visible=!0,madScientistWarehouse.anims.play("msTalk"),mute||speechBubbleSfx.play()},[],this),this.time.delayedCall(7500,function(){madScientistWarehouse.anims.play("msStand"),i.text="",s.anims.play("bubbleClose")},[],this)};var madScientistLabSprite,monster,victim,treadmill,treadmillTwo,speedText,lifeText,finished,readyToLeave,screamSfx,growlSfx,treadmillSfx,wooshSfx,zapSfx,labScene=new Phaser.Scene("lab");labScene.create=function(){if(activeScene="lab",5==possibleIngredientsArray.length){LoLApi("progress",{currentProgress:6,maximumProgress:13})}finished=!1,readyToLeave=!1;var e=this.add.image(512,276,"labBackground");e.setScale(2),this.add.image(850,200,"labSign"),madScientistLabSprite=this.add.sprite(880,480,"madScientist"),madScientistLabSprite.setScale(2),madScientistLabSprite.anims.play("msStand"),treadmill=this.add.sprite(200,500,"treadmill"),treadmill.setScale(2),treadmillTwo=this.add.sprite(500,500,"treadmill"),treadmillTwo.setScale(2),monster=this.add.sprite(200,436,"monsters"),monster.setScale(2),monster.setFrame(2),victim=this.add.sprite(500,436,"victims"),victim.setScale(2),victim.setFrame(0);var a=jsonText.labSpeech1;this.time.delayedCall(750,function(){this.createBubble(785,276,a)},[],this),mute||LoLApi("speakText",{key:"labSpeech1"}),this.add.text(445,206,"Speed (mph) :",{fontSize:"15px",fill:"#008106"}).setFontFamily("Verdana").setFontStyle("bold"),speedText=this.add.text(590,206,"0",{fontSize:"15px",fill:"#008106"}).setFontFamily("Verdana").setFontStyle("bold"),this.add.text(445,271,"Lifetime (sec) :",{fontSize:"15px",fill:"#008106"}).setFontFamily("Verdana").setFontStyle("bold"),lifeText=this.add.text(590,271,"0",{fontSize:"15px",fill:"#008106"}).setFontFamily("Verdana").setFontStyle("bold"),nextButton=this.add.sprite(512,526,"buttonLarge").setInteractive({useHandCursor:!0});var t=this;nextButton.on("pointerdown",function(){t.time.delayedCall(500,function(){labScene.nextStep()},[],this)}),nextButton.visible=!1,nextButtonLabel=this.add.text(517,526,jsonText.mainButton1,{fontSize:"38px",fill:"#000"}).setFontStyle("bold italic").setFontFamily("Arial").setPadding({right:16}).setOrigin(.5),nextButtonLabel.visible=!1,mute||(screamSfx=this.sound.add("scream"),zapSfx=this.sound.add("zap"),growlSfx=this.sound.add("growl"),wooshSfx=this.sound.add("woosh"),speechBubbleSfx=this.sound.add("pop"),treadmillSfx=this.sound.add("treadmill"))},labScene.setResults=function(){var e,a,t,s;return e=extraIngredient1.name,s=1,e===jsonText.possIngredients0?(a=7,t=8):e===jsonText.possIngredients1?(a=4,t=12):e===jsonText.possIngredients2?(a=6,t=9):e===jsonText.possIngredients3?(a=5,t=11):e===jsonText.possIngredients4?(a=6,t=12):e===jsonText.possIngredients5?(a=6,t=10):void 0,(1==s?(extraIngredient1.speed=a,extraIngredient1.lifetime=t):2==s?(extraIngredient2.speed=a,extraIngredient2.lifetime=t):3==s&&(extraIngredient3.speed=a,extraIngredient3.lifetime=t),[e,a,t])},labScene.testAnimation=function(){var e=this.setResults(),a=this.add.sprite(200,436,"electricEffect");a.setScale(3.5),a.anims.play("electricEffect"),mute||zapSfx.play(),this.time.delayedCall(500,function(){a.anims.stop("electricEffect"),a.visible=!1,monster.setFrame(1),mute||(zapSfx.stop(),growlSfx.play({volume:1.5}))},[],this),this.time.delayedCall(800,function(){monster.setFrame(5)},[],this),this.time.delayedCall(1300,function(){treadmill.anims.play("treadmillActive"),treadmillTwo.anims.play("treadmillActive"),monster.anims.play("monsterRun"),victim.anims.play("victimRun"),mute||(screamSfx.play(),treadmillSfx.play({loop:!0,volume:.75}))},[],this);var t;this.time.delayedCall(1e3*e[2],function(){monster.anims.stop("monsterRun"),monster.visible=!1,t=this.add.sprite(monster.x,monster.y,"zombieDeath"),t.setScale(2),t.anims.play("death"),mute||wooshSfx.play({volume:2}),this.tweens.add({targets:t,x:-100,ease:"Sine.easeIn",delay:300,duration:500})},[],this);for(var s=0,i=0,n=0,l=0;n<e[2];)n++,this.time.delayedCall(1e3*n,function(){if(s++,lifeText.text=s,s==e[2]){var a=jsonText.labSpeech2+e[2]+jsonText.labSpeech3+e[1]+jsonText.labSpeech4;finished=!0,this.time.delayedCall(2e3,function(){this.createBubble(785,276,a),mute||LoLApi("speakText",{key:"labSpeech6"})},[],this)}},[],this);for(;l<e[1];)l++,this.time.delayedCall(500*l,function(){i++,speedText.text=i},[],this)},labScene.createBubble=function(e,a,t){bubbleSprite=this.add.sprite(e,a,"speechBubble"),bubbleSprite.setScale(2),bubbleSprite.setTint(16711601),bubbleSprite.on("animationcomplete",function(e,a){this.emit("animationcomplete_"+e.key,e,a)},bubbleSprite),bubbleSprite.anims.play("bubbleOpen"),bubbleSprite.on("animationcomplete_bubbleOpen",function(){bubbleSprite.setFrame(3)}),bubbleSprite.on("animationcomplete_bubbleClose",function(){bubbleSprite.destroy()}),bubbleText=this.add.text(e,a-20,t,{fontSize:"26px",fill:"#000",wordWrap:{width:320,useAdvancedWrap:!0}}).setFontFamily("Verdana").setOrigin(.5),bubbleText.visible=!1,this.time.delayedCall(250,function(){bubbleText.visible=!0,madScientistLabSprite.anims.play("msTalk"),mute||speechBubbleSfx.play()},[],this),this.time.delayedCall(6e3,function(){madScientistLabSprite.anims.play("msStand"),nextButton.visible=!0,nextButtonLabel.visible=!0},[],this)},labScene.nextStep=function(){bubbleText.text="",bubbleSprite.anims.play("bubbleClose"),madScientistLabSprite.anims.play("msStand"),nextButton.visible=!1,nextButtonLabel.visible=!1,this.time.delayedCall(500,function(){if(!finished)labScene.testAnimation();else if(!readyToLeave){readyToLeave=!0;var e=jsonText.labSpeech5;this.createBubble(785,276,e),mute||LoLApi("speakText",{key:"labSpeech5"})}else this.time.delayedCall(500,function(){mute||treadmillSfx.stop(),labScene.scene.stop("lab"),activeScene="main",labScene.scene.start("main")},[],this)},[],this)};var gameScene=new Phaser.Scene("Game"),config={type:Phaser.AUTO,width:1024,height:576,parent:"phaser-app",pixelArt:!0,scene:[bootScene,preloadScene,menuScene,mainScene,warehouseScene,labScene,gameScene],backgroundColor:"#ccc"},game=new Phaser.Game(config);function LoLApi(e,a){parent.postMessage({message:e,payload:JSON.stringify(a)},"*")}